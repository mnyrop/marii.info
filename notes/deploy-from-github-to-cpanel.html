<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />

  <title>marii¨ | action! automate ftp deploys from github to cpanel</title>
  <meta name="description" content="The process leverages GitHub Actions to build, test, and deploy a compiled Jekyll site to a CPanel account on a shared Reclaim hosting server. With slight mo...">

  
  <link rel="icon" href="/assets/favicon.ico" />
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/notes/deploy-from-github-to-cpanel">

  <link rel="stylesheet" href="https:///ajax/libs/highlight.js/11.7.0/styles/base16/material-palenight.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F7LL67XEP6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F7LL67XEP6');
</script>

</head>


  <body>
    <div style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      background: #0e0e0e;
      background-image: url('/assets/banner.png');
      height: 100px;
      background-size: cover;
    "></div>

    <div class="container" style="padding-top:50px">
      <div class="bio">
  <div class="bio__header">
  	<a href="/" class="no-magic"><img src="/assets/snake.png" alt="2 headed snake logo" style="width:100px;"/></a>
  </div>
  <!-- <div class="bio__desc"></div> -->
  <div class="bio__menu">
    
    <a href="/">home</a>&nbsp;
    
    <a href="/about">cv</a>&nbsp;
    
    <a href="/listening">listening</a>&nbsp;
    
    <a href="/playing">playing</a>&nbsp;
    
    <a href="/reading">reading</a>&nbsp;
    
  </div>
</div>

      <div class="post">
        <hr>
        <h1><a href="/#notes">notes</a> > Action! Automate FTP deploys from GitHub to CPanel</h2>
        <p class="project__meta">
          10 February 2021
          <!-- <br>
          actions;ci;cpanel;github; -->
        </p>

        <div class="post__body">
          <img src="https://i.makeagif.com/media/5-21-2015/W4vUS3.gif" />
          <p><strong>The process leverages GitHub Actions to build, test, and deploy a compiled Jekyll site to a CPanel account on a shared Reclaim hosting server.</strong> With slight modification, it should work for any fully-static or statically-generated site and any ol’ server with FTP. Depending on how you build your site, the server shouldn’t need Apache or Nginx since we’ll syncing static files directly to <code class="language-plaintext highlighter-rouge">/public_html</code>.</p>

<h3 id="step-1-create-a-github-repository-with-your-site-files">Step 1. <strong>Create a GitHub repository with your site files</strong></h3>
<p>Feel free to use and remix <a href="https://github.com/nyu-dss/wh-deploilerplate">this template</a>.</p>

<h3 id="step-2-create-an-ftp-deploy-account-on-your-cpanel-account">Step 2. <strong>Create an FTP deploy account on your CPanel account</strong></h3>
<p>Log in to your dashboard and navigate to the “FTP Accounts” tab under “Files.”
<a href="/images/cpanel_ftp.png" class="no-magic"><img src="/images/cpanel_ftp.png" alt="ftp dashboard" /></a></p>

<p>Create a special FTP account just for deployments. Under “directory” put <code class="language-plaintext highlighter-rouge">public_html</code>. If you want the site to be in a subdirectory from the root URL (e.g., “marii.hosting.nyu.edu/my-site”), enter the subdirectory after <code class="language-plaintext highlighter-rouge">public_html</code> with no trailing slash (e.g., <code class="language-plaintext highlighter-rouge">public_html/my-site</code>).
<a href="/images/cpanel_ftp.png" class="no-magic"><img src="/images/create_ftp_account.png" alt="create ftp account" /></a></p>

<p>More info available <a href="https://docs.cpanel.net/cpanel/files/ftp-accounts/">here</a>.</p>

<h3 id="step-3-add-your-ftp-deploy-account-credentials-to-your-github-repo-secrets-settings">Step 3. <strong>Add your FTP deploy account credentials to your GitHub repo secrets settings</strong></h3>
<p>Since our GitHub repo will initiate FTP deployments for us, we need to give it our new credentials. To do so, navigate to your repo &gt; Settings &gt; Secrets. As the page says, “Secrets are environment variables that are encrypted” and made available to Actions workflows. The deployment workflow we’ll define in the next step needs three environment vars: <code class="language-plaintext highlighter-rouge">FTP_SERVER</code>, <code class="language-plaintext highlighter-rouge">FTP_USERNAME</code>, and <code class="language-plaintext highlighter-rouge">FTP_PASSWORD</code>.  These need to be spelled verbatim unless you plan on customizing the action files.</p>

<p>Click “New repository secret” and create the variables one by one using the credentials you made in the last step. Note that <code class="language-plaintext highlighter-rouge">FTP_USERNAME</code> should have the “Log In” name you created, e.g, “my-deployer-name”. The <code class="language-plaintext highlighter-rouge">FTP_SERVER</code> should be the “Host” you entered with no additional file paths or protocols.</p>

<p><a href="/images/secrets_dash.png" class="no-magic"><img src="/images/secrets_dash.png" alt="secrets dashboard" /></a></p>

<p>More info available <a href="https://docs.github.com/en/actions/reference/encrypted-secrets">here</a>.</p>

<h3 id="step-4-configure-github-actions-workflow-for-your-repo">Step 4. <strong>Configure GitHub Actions workflow for your repo</strong></h3>

<p>To set up a GitHub actions workflow, you’ll define a set of steps and settings in YAML format and put them in your repo in a special directory <code class="language-plaintext highlighter-rouge">.github/workflows</code>. If you’re using the <a href="https://github.com/nyu-dss/wh-deploilerplate">template</a>, this is already set up.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># build, test, and ftp deploy a jekyll site</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">ci:deploy</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">main</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">env</span><span class="pi">:</span>
      <span class="na">BASEURL</span><span class="pi">:</span> <span class="s1">'</span><span class="s">'</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">fetch-depth</span><span class="pi">:</span> <span class="m">1</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">bundler-cache</span><span class="pi">:</span> <span class="no">true</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">install</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">gem install bundler &amp;&amp; bundle</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">build</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">bundle exec rake build</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">test</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">bundle exec rake test</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">deploy</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">SamKirkland/FTP-Deploy-Action@4.0.0</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">server</span><span class="pi">:</span> <span class="s">${{secrets.FTP_SERVER}}</span>
          <span class="na">username</span><span class="pi">:</span> <span class="s">${{secrets.FTP_USERNAME}}@{{secrets.FTP_SERVER}}</span>
          <span class="na">password</span><span class="pi">:</span> <span class="s">${{secrets.FTP_PASSWORD}}</span>
          <span class="na">local-dir</span><span class="pi">:</span> <span class="s">./_site/</span>

</code></pre></div></div>

<p><img src="https://thumbs.gfycat.com/AlarmingVeneratedArgentinehornedfrog-small.gif" alt="deploy gif" /></p>

<p>More info available <a href="https://docs.github.com/en/actions">here</a>.</p>

        </div>

        
          <div class="post__paginate">
            
              <span class="post__paginate-left">
                <a href="/notes/ghostscript-for-washed-out-pdfs">Using Ghostscript to Covert Washed-Out PDFs to PNGs for OCR Processing</a>
              </span>
            

            
          </div>
        
      </div>

      
  <ul class="rows">
    <li class="row__cols">
      <div class="row__title">
        
          Notes
        
      </div>
      <div class="row__date">
          Date
      </div>
      <div class="row__cat">
        
          Tags
        
      </div>
    </li>
    
      <li class="row__post">
        <div class="row__title row__active">
          <a href="/notes/deploy-from-github-to-cpanel">
            Action! Automate FTP deploys from GitHub to CPanel
          </a>
        </div>
        <div class="row__date row__active">
          2021
        </div>
        <div class="row__cat row__active">actions;ci;cpanel;github;</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/ghostscript-for-washed-out-pdfs">
            Using Ghostscript to Covert Washed-Out PDFs to PNGs for OCR Processing
          </a>
        </div>
        <div class="row__date ">
          2020
        </div>
        <div class="row__cat ">ghostscript;ocr;bash</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/nycdh-2018">
            NYCDH Week Workshop: Publishing Sites with GitHub Pages
          </a>
        </div>
        <div class="row__date ">
          2018
        </div>
        <div class="row__cat ">jekyll;workshop;github;dh</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/static-iiif-annotations">
            Create and store static IIIF annotations Minicomp style
          </a>
        </div>
        <div class="row__date ">
          2018
        </div>
        <div class="row__cat ">jekyll;iiif;rake</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/govt-document-pipeline">
            Create a Gov't Document Pipeline from Scraping to Full Text OCR
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">bs4;tesseract;ocr</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/headless-test-dynamic-search">
            Continuous Integration II: Headless Tests w/ RSpec, Capybara, and Poltergeist
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">ci;rspec;capybara;poltergeist</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/jekyll-ci">
            Continuous Integration! Or: Jekyll gets some robot nannies.
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">jekyll;ci</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/automate-yr-docs-mysql-to-markown-via-py">
            Automate docs for DB updates with Pandas + Markdown
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">documentation;myql;python;markdown</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/the-summer-of-puppets-4">
            The Summer of Japanese Puppets, Part 4
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">d3js;lunr;jekyll</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/the-summer-of-puppets-3">
            The Summer of Japanese Puppets, Part 3
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">jekyll;github-pages;liquid</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/the-summer-of-puppets-2">
            The Summer of Japanese Puppets, Part 2
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">jupyter;python;json;openrefine</div>
      </li>
    
      <li class="row__post">
        <div class="row__title ">
          <a href="/notes/the-summer-of-puppets">
            The Summer of Japanese Puppets, Part 1
          </a>
        </div>
        <div class="row__date ">
          2017
        </div>
        <div class="row__cat ">sql;jekyll;php</div>
      </li>
    
  </ul>


    </div>
  </body>

</html>
